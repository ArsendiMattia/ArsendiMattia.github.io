---
title: Understanding the Hessian of the log posterior
date: 2024-09-17
comments: true
toc: true
math: true
---

I want to compute $ \nabla^2_{\boldsymbol{\theta}} \log p( \boldsymbol{\theta} \mid \boldsymbol{y}, \boldsymbol{x}) $, where $\boldsymbol{\theta} \in \Theta^J$, $\boldsymbol{x} \in X^N$ and $\boldsymbol{y} \in Y^N$. 

$$
\begin{align}
  \log p( \boldsymbol{\theta} \mid \boldsymbol{y}, \boldsymbol{x}) 
  &\propto \log p(\boldsymbol{\theta}, \boldsymbol{y}, \boldsymbol{x}) \nonumber \\
  &\propto \log p(\boldsymbol{y} \mid \boldsymbol{\theta}, \boldsymbol{x}) + \log p(\boldsymbol{x}) + \log p(\boldsymbol{\theta}) \nonumber \\
  &\propto \log p(\boldsymbol{y} \mid \boldsymbol{\theta}, \boldsymbol{x}) + \log p(\boldsymbol{\theta}) \, , \nonumber
\end{align}
$$

where
$$
\begin{align}
\log p(\boldsymbol{y} \mid \boldsymbol{\theta}, \boldsymbol{x})
&= \log \prod_{n=1}^N p(y_n \mid \boldsymbol{\theta}, x_n) \nonumber \\
&= \log \prod_{n=1}^N \text{Bernoulli}(y_n \mid p = f(x_n; \theta)) \nonumber \\ 
&= \sum_{n=1}^N \log f(x_n; \theta)^{y_n} + \log (1 - f(x_n; \theta))^{1-y_n} \, .
\end{align}
$$

A typical case assumes a Multivariate Normal distribution as the prior distribution over $\boldsymbol{\theta}$, thus leading to

$$
\begin{align}
p(\boldsymbol{\theta}) \sim \mathcal{N}_J(\boldsymbol{0}, \boldsymbol{\Sigma}) \, ,
\end{align}
$$

therefore
$$
\begin{align}
\log p(\boldsymbol{\theta}) \propto -\frac{1}{2} \boldsymbol{\theta}^T \boldsymbol{\Sigma}^{-1}  \boldsymbol{\theta} \, .
\end{align}
$$

The Jacobian of the $\log p( \boldsymbol{\theta} \mid \boldsymbol{y}, \boldsymbol{x})$ is equal to

$$
\begin{align}
\left[
\begin{array}{c}
\frac{\partial \log p(\boldsymbol{y} \mid \boldsymbol{\theta}, \boldsymbol{x})}{\partial \theta_1} \\
\frac{\partial \log p(\boldsymbol{y} \mid \boldsymbol{\theta}, \boldsymbol{x})}{\partial \theta_2} \\
\vdots \\
\frac{\partial \log p(\boldsymbol{y} \mid \boldsymbol{\theta}, \boldsymbol{x})}{\partial \theta_J} \\
\end{array}
\right] = 

\end{align}
$$


**WORK IN PROGRESS**

